<!DOCTYPE html>
<html>
    <head>
        <title>Connectify - Post</title>
        <link rel="icon" href="resources/Logo.svg" type="image/svg+xml">
        <link rel="stylesheet" type="text/css" href="postPage.css">
    </head>
    <body>
          <header>
               <div id="headercol1">
                    <img id="logo" src="resources/Logo.svg" />
                    <p id="appName"> Connectify </p>
               </div>
               <div id="headercol2">
                    <div class="searchBar">
                         <img src="resources/Trailing-Elements.svg" alt="Search Icon">
                         <input type="text" id="search" name="search" placeholder="Search #tags or ::words::" required>
                    </div>
          
                    <!-- IF USER IS NOT LOGGED IN -->
                    <button id="logInButton" onclick="window.location.href='loginPage.html'">Log In</button>
               </div>
          </header>
        
        <main>
            <div class="goBackLink" onclick="window.location.href='homePage.html'">
                <span class="arrow">&#8604;</span>
                <span class="back">Back</span>
            </div>

            <div id="post">
                <div class="postHeader">
                    <div class="userInfo">
                        <div class="avatar">C</div>
                        <div class="username-and-time">
                            <div class="username">Username</div>
                            <div class="time">4 hours ago</div>
                        </div>
                    </div>
                    <!-- IF POST BELONGS TO USER
                    <button class="optionsButton" id="postOptions">
                        <img src="resources/Options Button.svg" alt="Options">
                    </button> -->
                </div>
                <div id="tags">
                    <a href="">#funny</a>
                    <a href="">#life</a>
                </div>
                <div id="postTitle">
                    This is a title
                </div>
                <div id="postText">
                    Lorem ipsum dolor sit amet, consectetur adipiscing elit. Proin ac tortor sed velit luctus malesuada. Aenean suscipit, arcu et pulvinar tincidunt, lorem felis tempor quam, sed euismod turpis neque et lorem. Fusce id libero ut nulla fringilla interdum. Curabitur posuere metus non nibh.
                </div>

                <div class="postContent">
                    <div id="placeholderContent"></div>
                </div>

                <div class="postActions">
                    <button class="actionButton">
                        <img src="resources/Heart.svg" alt="Like">
                        <span class="counter">42</span>
                    </button>
                    <div class="separator"></div>
                    <button class="actionButton">
                        <img src="resources/HeartCrack.svg" alt="Dislike">
                        <span class="counter">7</span>
                    </button>
                    <button class="actionButton"><img src="resources/Comments.svg" alt="Comment"></button>
                    <button class="actionButton"><img src="resources/Bookmark.svg" alt="Bookmark"></button>
                </div>
            </div>

            <div id="comments">
                <h2>Comments</h2>
                <div class="horizontalBar"></div>
                <div class="comment-thread">
                    <div class="comment">
                        <div class="postHeader">
                            <div class="userInfo">
                                <div class="avatar">A</div>
                                <div class="username-and-time">
                                    <div class="username">Username</div>
                                    <div class="time">4 hours ago</div>
                                </div>
                            </div>
                            <!-- IF COMMENT BELONGS TO USER
                            <button class="optionsButton">
                                <img src="resources/Options Button.svg" alt="Options">
                            </button> -->
                        </div>
                        <div class="commentText">
                            Main comment text goes here
                        </div>
                        <div class="commentActions">
                            <button class="actionButton">
                                <img src="resources/Heart.svg" alt="Like">
                                <span class="counter">42</span>
                            </button>
                            <div class="separator"></div>
                            <button class="actionButton">
                                <img src="resources/HeartCrack.svg" alt="Dislike">
                                <span class="counter">7</span>
                            </button>
                            <button class="actionButton"><img src="resources/Comments.svg" alt="Comment"></button>
                            <button class="actionButton"><img src="resources/Bookmark.svg" alt="Bookmark"></button>
                        </div>
            
                        <div class="nestedCommentsContainer">
                            <div class="nestedCommentTrigger">
                                <div class="nestedCommentLine"></div>
                                <button class="viewRepliesButton">View Replies (2)</button>
                            </div>
            
                            <div class="nestedComments">
                                <div class="comment nested-level-1">
                                    <div class="postHeader">
                                        <div class="userInfo">
                                            <div class="avatar">B</div>
                                            <div class="username-and-time">
                                                <div class="usernames">
                                                    <span class="username">Replier Name</span>
                                                    <span class="replyTo">in reply to @Username</span>
                                                </div>
                                                <div class="time">3 hours ago</div>
                                            </div>
                                        </div>
                                        <!-- IF COMMENT BELONGS TO USER
                                        <button class="optionsButton">
                                             <img src="resources/Options Button.svg" alt="Options">
                                        </button> -->
                                    </div>
                                    <div class="commentText">
                                        First nested reply text
                                    </div>
                                    <div class="commentActions">
                                        <button class="actionButton">
                                            <img src="resources/Heart.svg" alt="Like">
                                            <span class="counter">42</span>
                                        </button>
                                        <div class="separator"></div>
                                        <button class="actionButton">
                                            <img src="resources/HeartCrack.svg" alt="Dislike">
                                            <span class="counter">7</span>
                                        </button>
                                        <button class="actionButton"><img src="resources/Comments.svg" alt="Comment"></button>
                                        <button class="actionButton"><img src="resources/Bookmark.svg" alt="Bookmark"></button>
                                    </div>
            
                                    <div class="nestedCommentsContainer">
                                        <div class="nestedCommentTrigger">
                                            <div class="nestedCommentLine"></div>
                                            <button class="viewRepliesButton">View Replies (1)</button>
                                        </div>
            
                                        <div class="nestedComments">
                                            <div class="comment nested-level-2">
                                                <div class="postHeader">
                                                    <div class="userInfo">
                                                        <div class="avatar">C</div>
                                                        <div class="username-and-time">
                                                            <div class="usernames">
                                                                <span class="username">Another Replier</span>
                                                                <span class="replyTo">in reply to @Replier Name</span>
                                                            </div>
                                                            <div class="time">2 hours ago</div>
                                                        </div>
                                                    </div>
                                                    <!-- IF COMMENT BELONGS TO USER
                                                       <button class="optionsButton">
                                                            <img src="resources/Options Button.svg" alt="Options">
                                                       </button> -->
                                                </div>
                                                <div class="commentText">
                                                    Second level nested reply
                                                </div>
                                                <div class="commentActions">
                                                    <button class="actionButton">
                                                        <img src="resources/Heart.svg" alt="Like">
                                                        <span class="counter">42</span>
                                                    </button>
                                                    <div class="separator"></div>
                                                    <button class="actionButton">
                                                        <img src="resources/HeartCrack.svg" alt="Dislike">
                                                        <span class="counter">7</span>
                                                    </button>
                                                    <button class="actionButton"><img src="resources/Comments.svg" alt="Comment"></button>
                                                    <button class="actionButton"><img src="resources/Bookmark.svg" alt="Bookmark"></button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="comment nested-level-1">
                                    <div class="postHeader">
                                        <div class="userInfo">
                                            <div class="avatar">B</div>
                                            <div class="username-and-time">
                                                <div class="usernames">
                                                    <span class="username">Replier Name</span>
                                                    <span class="replyTo">in reply to @Username</span>
                                                </div>
                                                <div class="time">3 hours ago</div>
                                            </div>
                                        </div>
                                        <!-- IF COMMENT BELONGS TO USER
                                        <button class="optionsButton">
                                             <img src="resources/Options Button.svg" alt="Options">
                                        </button> -->
                                    </div>
                                    <div class="commentText">
                                        First nested reply text
                                    </div>
                                    <div class="commentActions">
                                        <button class="actionButton">
                                            <img src="resources/Heart.svg" alt="Like">
                                            <span class="counter">42</span>
                                        </button>
                                        <div class="separator"></div>
                                        <button class="actionButton">
                                            <img src="resources/HeartCrack.svg" alt="Dislike">
                                            <span class="counter">7</span>
                                        </button>
                                        <button class="actionButton"><img src="resources/Comments.svg" alt="Comment"></button>
                                        <button class="actionButton"><img src="resources/Bookmark.svg" alt="Bookmark"></button>
                                    </div>
            
                                    <div class="nestedCommentsContainer">
                                        <div class="nestedCommentTrigger">
                                            <div class="nestedCommentLine"></div>
                                            <button class="viewRepliesButton">View Replies (1)</button>
                                        </div>
            
                                        <div class="nestedComments">
                                            <div class="comment nested-level-2">
                                                <div class="postHeader">
                                                    <div class="userInfo">
                                                        <div class="avatar">C</div>
                                                        <div class="username-and-time">
                                                            <div class="usernames">
                                                                <span class="username">Another Replier</span>
                                                                <span class="replyTo">in reply to @Replier Name</span>
                                                            </div>
                                                            <div class="time">2 hours ago</div>
                                                        </div>
                                                    </div>
                                                    <!-- IF COMMENT BELONGS TO USER
                                                       <button class="optionsButton">
                                                            <img src="resources/Options Button.svg" alt="Options">
                                                       </button> -->
                                                </div>
                                                <div class="commentText">
                                                    Second level nested reply
                                                </div>
                                                <div class="commentActions">
                                                    <button class="actionButton">
                                                        <img src="resources/Heart.svg" alt="Like">
                                                        <span class="counter">42</span>
                                                    </button>
                                                    <div class="separator"></div>
                                                    <button class="actionButton">
                                                        <img src="resources/HeartCrack.svg" alt="Dislike">
                                                        <span class="counter">7</span>
                                                    </button>
                                                    <button class="actionButton"><img src="resources/Comments.svg" alt="Comment"></button>
                                                    <button class="actionButton"><img src="resources/Bookmark.svg" alt="Bookmark"></button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>   
                    </div>
                    <div class="comment">
                        <div class="postHeader">
                            <div class="userInfo">
                                <div class="avatar">A</div>
                                <div class="username-and-time">
                                    <div class="username">Username</div>
                                    <div class="time">4 hours ago</div>
                                </div>
                            </div>
                            <!-- IF COMMENT BELONGS TO USER
                            <button class="optionsButton">
                                <img src="resources/Options Button.svg" alt="Options">
                            </button> -->
                        </div>
                        <div class="commentText">
                            Main comment text goes here
                        </div>
                        <div class="commentActions">
                            <button class="actionButton">
                                <img src="resources/Heart.svg" alt="Like">
                                <span class="counter">42</span>
                            </button>
                            <div class="separator"></div>
                            <button class="actionButton">
                                <img src="resources/HeartCrack.svg" alt="Dislike">
                                <span class="counter">7</span>
                            </button>
                            <button class="actionButton"><img src="resources/Comments.svg" alt="Comment"></button>
                            <button class="actionButton"><img src="resources/Bookmark.svg" alt="Bookmark"></button>
                        </div>
            
                        <div class="nestedCommentsContainer">
                            <div class="nestedCommentTrigger">
                                <div class="nestedCommentLine"></div>
                                <button class="viewRepliesButton">View Replies (1)</button>
                            </div>
            
                            <div class="nestedComments">
                                <div class="comment nested-level-1">
                                    <div class="postHeader">
                                        <div class="userInfo">
                                            <div class="avatar">B</div>
                                            <div class="username-and-time">
                                                <div class="usernames">
                                                    <span class="username">Replier Name</span>
                                                    <span class="replyTo">in reply to @Username</span>
                                                </div>
                                                <div class="time">3 hours ago</div>
                                            </div>
                                        </div>
                                        <!-- IF COMMENT BELONGS TO USER
                                        <button class="optionsButton">
                                             <img src="resources/Options Button.svg" alt="Options">
                                        </button> -->
                                    </div>
                                    <div class="commentText">
                                        First nested reply text
                                    </div>
                                    <div class="commentActions">
                                        <button class="actionButton">
                                            <img src="resources/Heart.svg" alt="Like">
                                            <span class="counter">42</span>
                                        </button>
                                        <div class="separator"></div>
                                        <button class="actionButton">
                                            <img src="resources/HeartCrack.svg" alt="Dislike">
                                            <span class="counter">7</span>
                                        </button>
                                        <button class="actionButton"><img src="resources/Comments.svg" alt="Comment"></button>
                                        <button class="actionButton"><img src="resources/Bookmark.svg" alt="Bookmark"></button>
                                    </div>
            
                                    <div class="nestedCommentsContainer">
                                        <div class="nestedCommentTrigger">
                                            <div class="nestedCommentLine"></div>
                                            <button class="viewRepliesButton">View Replies (1)</button>
                                        </div>
            
                                        <div class="nestedComments">
                                            <div class="comment nested-level-2">
                                                <div class="postHeader">
                                                    <div class="userInfo">
                                                        <div class="avatar">C</div>
                                                        <div class="username-and-time">
                                                            <div class="usernames">
                                                                <span class="username">Another Replier</span>
                                                                <span class="replyTo">in reply to @Replier Name</span>
                                                            </div>
                                                            <div class="time">2 hours ago</div>
                                                        </div>
                                                    </div>
                                                    <!-- IF COMMENT BELONGS TO USER
                                                       <button class="optionsButton">
                                                            <img src="resources/Options Button.svg" alt="Options">
                                                       </button> -->
                                                </div>
                                                <div class="commentText">
                                                    Second level nested reply
                                                </div>
                                                <div class="commentActions">
                                                    <button class="actionButton">
                                                        <img src="resources/Heart.svg" alt="Like">
                                                        <span class="counter">42</span>
                                                    </button>
                                                    <div class="separator"></div>
                                                    <button class="actionButton">
                                                        <img src="resources/HeartCrack.svg" alt="Dislike">
                                                        <span class="counter">7</span>
                                                    </button>
                                                    <button class="actionButton"><img src="resources/Comments.svg" alt="Comment"></button>
                                                    <button class="actionButton"><img src="resources/Bookmark.svg" alt="Bookmark"></button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>   
                    </div>
                    <div class="comment">
                        <div class="postHeader">
                            <div class="userInfo">
                                <div class="avatar">A</div>
                                <div class="username-and-time">
                                    <div class="username">Username</div>
                                    <div class="time">4 hours ago</div>
                                </div>
                            </div>
                            <!-- IF COMMENT BELONGS TO USER
                            <button class="optionsButton">
                                <img src="resources/Options Button.svg" alt="Options">
                            </button> -->
                        </div>
                        <div class="commentText">
                            Main comment text goes here
                        </div>
                        <div class="commentActions">
                            <button class="actionButton">
                                <img src="resources/Heart.svg" alt="Like">
                                <span class="counter">42</span>
                            </button>
                            <div class="separator"></div>
                            <button class="actionButton">
                                <img src="resources/HeartCrack.svg" alt="Dislike">
                                <span class="counter">7</span>
                            </button>
                            <button class="actionButton"><img src="resources/Comments.svg" alt="Comment"></button>
                            <button class="actionButton"><img src="resources/Bookmark.svg" alt="Bookmark"></button>
                        </div>
            
                        <div class="nestedCommentsContainer">
                            <div class="nestedCommentTrigger">
                                <div class="nestedCommentLine"></div>
                                <button class="viewRepliesButton">View Replies (1)</button>
                            </div>
            
                            <div class="nestedComments">
                                <div class="comment nested-level-1">
                                    <div class="postHeader">
                                        <div class="userInfo">
                                            <div class="avatar">B</div>
                                            <div class="username-and-time">
                                                <div class="usernames">
                                                    <span class="username">Replier Name</span>
                                                    <span class="replyTo">in reply to @Username</span>
                                                </div>
                                                <div class="time">3 hours ago</div>
                                            </div>
                                        </div>
                                        <!-- IF COMMENT BELONGS TO USER
                                        <button class="optionsButton">
                                             <img src="resources/Options Button.svg" alt="Options">
                                        </button> -->
                                    </div>
                                    <div class="commentText">
                                        First nested reply text
                                    </div>
                                    <div class="commentActions">
                                        <button class="actionButton">
                                            <img src="resources/Heart.svg" alt="Like">
                                            <span class="counter">42</span>
                                        </button>
                                        <div class="separator"></div>
                                        <button class="actionButton">
                                            <img src="resources/HeartCrack.svg" alt="Dislike">
                                            <span class="counter">7</span>
                                        </button>
                                        <button class="actionButton"><img src="resources/Comments.svg" alt="Comment"></button>
                                        <button class="actionButton"><img src="resources/Bookmark.svg" alt="Bookmark"></button>
                                    </div>
            
                                    <div class="nestedCommentsContainer">
                                        <div class="nestedCommentTrigger">
                                            <div class="nestedCommentLine"></div>
                                            <button class="viewRepliesButton">View Replies (1)</button>
                                        </div>
            
                                        <div class="nestedComments">
                                            <div class="comment nested-level-2">
                                                <div class="postHeader">
                                                    <div class="userInfo">
                                                        <div class="avatar">C</div>
                                                        <div class="username-and-time">
                                                            <div class="usernames">
                                                                <span class="username">Another Replier</span>
                                                                <span class="replyTo">in reply to @Replier Name</span>
                                                            </div>
                                                            <div class="time">2 hours ago</div>
                                                        </div>
                                                    </div>
                                                    <!-- IF COMMENT BELONGS TO USER
                                                       <button class="optionsButton">
                                                            <img src="resources/Options Button.svg" alt="Options">
                                                       </button> -->
                                                </div>
                                                <div class="commentText">
                                                    Second level nested reply
                                                </div>
                                                <div class="commentActions">
                                                    <button class="actionButton">
                                                        <img src="resources/Heart.svg" alt="Like">
                                                        <span class="counter">42</span>
                                                    </button>
                                                    <div class="separator"></div>
                                                    <button class="actionButton">
                                                        <img src="resources/HeartCrack.svg" alt="Dislike">
                                                        <span class="counter">7</span>
                                                    </button>
                                                    <button class="actionButton"><img src="resources/Comments.svg" alt="Comment"></button>
                                                    <button class="actionButton"><img src="resources/Bookmark.svg" alt="Bookmark"></button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>   
                    </div>
                </div>
            </div>
        </main>
        <script>
            document.querySelectorAll('.viewRepliesButton').forEach(button => {
                button.addEventListener('click', function() {
                    const nestedComments = this.closest('.nestedCommentsContainer').querySelector('.nestedComments');
                    nestedComments.style.display = nestedComments.style.display === 'none' ? 'block' : 'none';
                });
            });

            function iconClicked(button, iconType) {
                // Get the image within the button
                const img = button.querySelector('img');
                
                // Get the counter element if it exists
                const counter = button.querySelector('.counter');

                // Find the parent post or comment
                const post = button.closest('.post, .comment');
                
                // Path for different icon types
                const iconPaths = {
                    'heart': {
                        default: 'resources/Heart.svg',
                        clicked: 'resources/Heart-Clicked.svg'
                    },
                    'heartCrack': {
                        default: 'resources/HeartCrack.svg',
                        clicked: 'resources/HeartCrack-Clicked.svg'
                    },
                    'bookmark': {
                        default: 'resources/Bookmark.svg',
                        clicked: 'resources/Bookmark-Clicked.svg'
                    }
                };

                if (iconType === 'heart' || iconType === 'heartCrack') {
                    // Find like and dislike buttons
                    const likeButton = post.querySelector('.actionButton img[src*="Heart"]').closest('.actionButton');
                    const dislikeButton = post.querySelector('.actionButton img[src*="HeartCrack"]').closest('.actionButton');
                    
                    // Get like and dislike counters
                    const likeCounter = likeButton.querySelector('.counter');
                    const dislikeCounter = dislikeButton.querySelector('.counter');

                    // Determine current button details
                    const currentButton = iconType === 'heart' ? likeButton : dislikeButton;
                    const otherButton = iconType === 'heart' ? dislikeButton : likeButton;
                    const currentImg = currentButton.querySelector('img');
                    const otherImg = otherButton.querySelector('img');
                    const currentCounter = iconType === 'heart' ? likeCounter : dislikeCounter;
                    const otherCounter = iconType === 'heart' ? dislikeCounter : likeCounter;

                    // Normalize the current image's src path to ensure comparison works
                    const currentSrc = currentImg.src.split('/').pop(); // Extract only the filename
                    const isCurrentlyClicked = currentSrc === iconPaths[iconType].clicked.split('/').pop();

                    // Check the other button's state
                    const otherSrc = otherImg.src.split('/').pop();
                    const isOtherClicked = otherSrc === iconPaths[iconType === 'heart' ? 'heartCrack' : 'heart'].clicked.split('/').pop();

                    // Toggle current button state
                    if (isCurrentlyClicked) {
                        // If already clicked, reset (unlike/undislike)
                        currentImg.src = iconPaths[iconType].default;
                        currentCounter.textContent = Math.max(0, parseInt(currentCounter.textContent) - 1);
                    } else {
                        // If not clicked, set current button to clicked state
                        currentImg.src = iconPaths[iconType].clicked;
                        currentCounter.textContent = parseInt(currentCounter.textContent) + 1;

                        // If the other button was clicked, reset it
                        if (isOtherClicked) {
                            otherImg.src = iconPaths[iconType === 'heart' ? 'heartCrack' : 'heart'].default;
                            otherCounter.textContent = Math.max(0, parseInt(otherCounter.textContent) - 1);
                        }
                    }
                } else if (iconType === 'bookmark') {
                    // Bookmark button logic
                    const currentSrc = img.src.split('/').pop(); // Extract only the filename
                    const isCurrentlyBookmarked = currentSrc === iconPaths.bookmark.clicked.split('/').pop();

                    // Toggle bookmark state
                    if (isCurrentlyBookmarked) {
                        img.src = iconPaths.bookmark.default;
                    } else {
                        img.src = iconPaths.bookmark.clicked;
                    }
                }
            }

            // Add event listeners to all action buttons
            document.addEventListener('DOMContentLoaded', () => {
                document.querySelectorAll('.actionButton').forEach(button => {
                    button.addEventListener('click', function() {
                        const img = this.querySelector('img');
                        if (img.src.includes('Heart.svg') || img.src.includes('Heart-Clicked.svg')) {
                            iconClicked(this, 'heart');
                        } else if (img.src.includes('HeartCrack.svg') || img.src.includes('HeartCrack-Clicked.svg')) {
                            iconClicked(this, 'heartCrack');
                        } else if (img.src.includes('Bookmark.svg') || img.src.includes('Bookmark-Clicked.svg')) {
                            iconClicked(this, 'bookmark');
                        }
                    });
                });
            });
        </script>

          <script>
               // Get content from localStorage and display it
               const contentData = JSON.parse(localStorage.getItem('postData'));

               if (contentData) {
                    document.getElementById('postTitle').innerText = `${contentData.postTitle}`;
                    document.getElementById('postText').innerText = `${contentData.postText}`;

                    if (contentData.postImage) {
                         document.getElementById('placeholderContent').innerHTML = `<img src="${contentData.postImage}" id="postImage">`;
                    }

                    // Display tags as individual <a> elements
                    if (contentData.postTags && contentData.postTags.length > 0) {
                         const tagsContainer = document.getElementById('tags');
                         contentData.postTags.forEach(tag => {
                              const tagElement = document.createElement('a');
                              tagElement.href = `${tag}`;  // Set href (you can change this to a proper URL if needed)
                              tagElement.innerText = `${tag}`;  // Display the tag with a '#' symbol
                              tagsContainer.appendChild(tagElement);  // Append each tag as an individual <a> tag
                         });
                    }

               } else {
                    document.getElementById('post').innerText = "Post Not Found";
                    document.getElementById('comments').innerText = " ";
               }
          </script>
    </body>
</html>

